---
title: "[RUST] 러스트 프로그래밍 공식 가이드(제2판) 11장 요약"
description: 자동화 테스트 작성하기
author: 김우석
date: 2025-09-22 07:00:00 +0900
categories: [Rust, OfficialGuide]
tags: [Rust]
image:
  path: /assets/img/posts/rust/rust-logo.svg
---

## 테스트 작성 방법
- 테스트란, 테스트 할 코드가 의도대로 기능하는지 검증하는 함수를 말하며, 보통 아래 3가지 동작을 수행함
    - 필요한 데이터나 상태 설정
    - 테스트할 코드 실행
    - 의도한 결과가 나오는지 확인

### 테스트 함수 파헤치기
- 러스트에서 테스트란 `test` 속성(러스트 코드 조각에 대한 메타데이터를 의미)이 애너테이션된 함수를 말하며 `fn` 이전 줄에 `#[test]`를 추가하면 테스트 함수로 변경 됨
- 테스트는 `cargo test` 명령어로 실행되며, 이 명령어를 실행하면 러스트는 **속성이 표시된 함수를 실행**하고 결과를 보고하는 테스트 실행 바이너리를 빌드함
- 카고로 새 라이브러리 프로젝트를 생성할 때 마다 테스트 함수가 포함된 테스트 모듈이 자동으로 생성됨 (테스트 작성을 위한 템플릿을 제공)

### ssert! 매크로로 결과 검사하기
- 어떤 조건이 `true` 임을 보장하는 테스트를 작성할 땐 표준라이브러리가 제공하는 `assert!` 매크로가 유용
- `assert!`  매크로는 불리언값으로 평가되는 인수를 전달받고, true 값일 경우 아무일도 일어나지 않고 테스트는 통과하고 false 값일 경우 `panic!` 매크로를 호출하여 테스트를 실패하도록 만듦

### assert_eq!, assert_ne! 매크로를 이용한 동등 테스트
- 두 매크로는 각각 **동등한지(equanlity) 그렇지 않은지(inequality) 판단**하고, **단언 코드가 실패하면 두 값을 출력**하여 테스트 실패 사유를 더 알기 쉽게 보여줌
- 러스트의 단언 함수의 매개변수는 `left`, `right` 라고 지칭하며 예상값과 테스트 코드로 만들어진 값의 순서는 상관이 없음
- `assert_eq!` 매크로는 내부적으로 `==` 연산자를 사용 (같으면 통과)
- `assert_ne!` 매크로는 내부적으로 `!=` 연산자를 사용 (같지 않으면 통과)하며 **적어도 이 값은 되지 않아야 함**을 알고 있는 경우에 유용
- 두 매크로는 비교 연산자를 사용하므로 비교 대상 타입은 반드시 `PartialEq` 트레이트를 구현해야 하며, 던언에 실패시 `{:?}` 디버그 포맷으로 두 값 (`left`, `right`)을 출력하므로 `Debug` 트레이트도 구현해야 함

### 커스텀 실패 메시지 추가하기
- `assert!`, `assert_eq!`, `assert_ne!` 매크로에 필수적인 인수들 이후의 인수는 `format!` 매크로로 전달 되기 때문에 `{}` 자리표시자가 들어있는 포맷 문자열과 자리표시자에 들어갈 값을 전달할 수 있음
- 커스텀 메시지는 테스트 단언의 의미를 서술하는데 유용

### should_panic 매크로로 패닉 발생 검사하기
- `#[should_panic]` 속성은 테스트 내부에서 패닉이 발생해야 통과되고, 패닉이 발생하지 않으면 실패
- `should_panic`을 사용하는 테스트는 의도한 것과 다른 이유로 패닉이 발생하더라도 테스트가 통과하기 때문에 정확하지 않은데, 이때 `should_panic`의 속성에 `expected` 매개변수를 추가해 포함되어야 하는 메시지를 지정할 수 있음
    - 매개변수 값이 패닉 메시지 문자열의 일부라면 테스트는 통과
    - 매개변수 값이 패닉 메시지 문자열에 포함되지 않는다면 테스트는 실패